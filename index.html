<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Aprendo Contigo</title>
<style>
  body {
    font-family: 'Comic Sans MS', cursive, sans-serif;
    text-align: center;
    padding: 20px;
    transition: background-color 0.5s;
  }
  body.ni√±o {
    background-color: #d0e6ff;
  }
  body.ni√±a {
    background-color: #ffe6f0;
  }
  button {
    margin: 10px 8px;
    padding: 12px 25px;
    font-size: 18px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    background-color: #8ecae6;
    color: white;
    transition: background-color 0.3s;
    min-width: 90px;
  }
  button:hover {
    background-color: #219ebc;
  }
  input[type="text"] {
    padding: 10px;
    font-size: 16px;
    border-radius: 5px;
    border: 1px solid #ccc;
    margin-bottom: 15px;
    width: 80%;
    max-width: 300px;
  }
  #feedback {
    margin-top: 15px;
    font-weight: bold;
    min-height: 1.5em;
  }
  .question {
    margin-bottom: 20px;
    font-size: 24px;
  }
</style>
</head>
<body>
  <div id="app">
    <h1>üëã Bienvenido a Aprendo Contigo</h1>
    <p>¬øCu√°l es tu nombre?</p>
    <input type="text" id="nombreInput" placeholder="Escribe tu nombre aqu√≠..." />
    <p>Selecciona tu g√©nero:</p>
    <button onclick="seleccionarGenero('ni√±o')">Ni√±o ‚ôÇÔ∏è</button>
    <button onclick="seleccionarGenero('ni√±a')">Ni√±a ‚ôÄÔ∏è</button>
  </div>

<script>
  let genero = '';
  let nombre = '';
  let vozSeleccionada = null;
  let areaActual = '';
  let juegoActual = 0;

  const juegos = {
    matematicas: [
      {
        preguntaTexto: '¬øCu√°ntos conejitos ves?',
        preguntaVisual: 'üê∞üê∞üê∞ ¬øCu√°ntos conejitos ves?',
        opciones: ['2', '3', '4'],
        correcta: '3'
      },
      {
        preguntaTexto: '¬øQu√© n√∫mero viene despu√©s de cinco?',
        preguntaVisual: 'üìä ¬øQu√© n√∫mero viene despu√©s de 5?',
        opciones: ['6', '4', '7'],
        correcta: '6'
      },
      {
        preguntaTexto: '¬øCu√°nto es dos m√°s uno?',
        preguntaVisual: '‚ûï ¬øCu√°nto es 2 + 1?',
        opciones: ['3', '4', '2'],
        correcta: '3'
      },
      {
        preguntaTexto: '¬øQu√© forma es esta? Un cuadrado, un c√≠rculo o un tri√°ngulo.',
        preguntaVisual: 'üî∑ ¬øQu√© forma es esta? ‚¨ú üîµ üî∫',
        opciones: ['Cuadrado', 'C√≠rculo', 'Tri√°ngulo'],
        correcta: 'Cuadrado'
      },
      {
        preguntaTexto: '¬øCu√°ntos animales hay?',
        preguntaVisual: 'üê∂üê±üê∞üê∂ ¬øCu√°ntos animales hay?',
        opciones: ['3', '4', '5'],
        correcta: '4'
      }
    ],

    lenguaje: [
      {
        preguntaTexto: '¬øCu√°l es la primera letra de la palabra gato?',
        preguntaVisual: 'üê± ¬øCu√°l es la primera letra de la palabra gato?',
        opciones: ['g', 'a', 'o'],
        correcta: 'g'
      },
      {
        preguntaTexto: '¬øQu√© palabra es un saludo?',
        preguntaVisual: 'üëã ¬øCu√°l es un saludo?',
        opciones: ['Hola', 'Adi√≥s', 'Casa'],
        correcta: 'Hola'
      },
      {
        preguntaTexto: '¬øQu√© animal hace "miau"?',
        preguntaVisual: 'üê± ¬øQu√© animal hace "miau"?',
        opciones: ['Perro', 'Gato', 'P√°jaro'],
        correcta: 'Gato'
      },
      {
        preguntaTexto: '¬øQu√© letra falta? C _ n',
        preguntaVisual: 'C _ n',
        opciones: ['a', 'o', 'u'],
        correcta: 'a'
      },
      {
        preguntaTexto: '¬øCu√°l es la √∫ltima letra de la palabra sol?',
        preguntaVisual: '‚òÄÔ∏è ¬øCu√°l es la √∫ltima letra de la palabra sol?',
        opciones: ['l', 's', 'o'],
        correcta: 'l'
      }
    ],

    habilidadesSociales: [
      {
        preguntaTexto: '¬øC√≥mo saludas a un amigo?',
        preguntaVisual: '¬øC√≥mo saludas a un amigo?',
        opciones: ['Hola', 'Ignor√°ndolo', 'Gritando'],
        correcta: 'Hola'
      },
      {
        preguntaTexto: 'Si alguien est√° triste, ¬øqu√© haces?',
        preguntaVisual: '¬øQu√© haces si alguien est√° triste?',
        opciones: ['Lo ayudas', 'Te r√≠es', 'Lo ignoras'],
        correcta: 'Lo ayudas'
      },
      {
        preguntaTexto: '¬øQu√© palabra usamos para pedir permiso?',
        preguntaVisual: '¬øQu√© palabra usamos para pedir permiso?',
        opciones: ['Por favor', 'Gracias', 'Adi√≥s'],
        correcta: 'Por favor'
      },
      {
        preguntaTexto: '¬øQu√© haces cuando quieres compartir?',
        preguntaVisual: '¬øQu√© haces cuando quieres compartir?',
        opciones: ['Doy mis cosas', 'Las guardo', 'Las tiro'],
        correcta: 'Doy mis cosas'
      },
      {
        preguntaTexto: '¬øQu√© es ser amable?',
        preguntaVisual: '¬øQu√© es ser amable?',
        opciones: ['Ser bueno con otros', 'Pelear', 'Gritar'],
        correcta: 'Ser bueno con otros'
      }
    ],

    autonomia: [
      {
        preguntaTexto: '¬øQu√© debes hacer antes de comer?',
        preguntaVisual: '¬øQu√© debes hacer antes de comer?',
        opciones: ['Lavarte las manos', 'Jugar', 'Dormir'],
        correcta: 'Lavarte las manos'
      },
      {
        preguntaTexto: '¬øD√≥nde debes guardar tus juguetes?',
        preguntaVisual: '¬øD√≥nde debes guardar tus juguetes?',
        opciones: ['En su lugar', 'En la calle', 'En la cama'],
        correcta: 'En su lugar'
      },
      {
        preguntaTexto: '¬øQu√© haces si tienes sed?',
        preguntaVisual: '¬øQu√© haces si tienes sed?',
        opciones: ['Tomar agua', 'Comer dulces', 'Correr'],
        correcta: 'Tomar agua'
      },
      {
        preguntaTexto: '¬øQu√© haces si te ensucias?',
        preguntaVisual: '¬øQu√© haces si te ensucias?',
        opciones: ['Lavarte', 'Ignorar', 'Comer'],
        correcta: 'Lavarte'
      },
      {
        preguntaTexto: '¬øQu√© debes hacer para dormir bien?',
        preguntaVisual: '¬øQu√© debes hacer para dormir bien?',
        opciones: ['Acostarte temprano', 'Jugar mucho', 'Comer mucho'],
        correcta: 'Acostarte temprano'
      }
    ],

    creatividad: [
      {
        preguntaTexto: '¬øQu√© color obtienes mezclando rojo y azul?',
        preguntaVisual: 'üé® ¬øQu√© color obtienes mezclando rojo y azul?',
        opciones: ['Morado', 'Verde', 'Naranja'],
        correcta: 'Morado'
      },
      {
        preguntaTexto: '¬øCu√°l es la forma con tres lados?',
        preguntaVisual: '‚úèÔ∏è ¬øCu√°l es la forma con tres lados?',
        opciones: ['Tri√°ngulo', 'Cuadrado', 'C√≠rculo'],
        correcta: 'Tri√°ngulo'
      },
      {
        preguntaTexto: '¬øQu√© puedes usar para dibujar?',
        preguntaVisual: 'üñçÔ∏è ¬øQu√© puedes usar para dibujar?',
        opciones: ['L√°piz', 'Tenis', 'Libro'],
        correcta: 'L√°piz'
      },
      {
        preguntaTexto: '¬øQu√© instrumento puedes tocar con tus manos?',
        preguntaVisual: 'ü•Å ¬øQu√© instrumento puedes tocar con tus manos?',
        opciones: ['Bater√≠a', 'Piano', 'Guitarra'],
        correcta: 'Bater√≠a'
      },
      {
        preguntaTexto: '¬øQu√© se necesita para pintar un cuadro?',
        preguntaVisual: 'üé® ¬øQu√© se necesita para pintar un cuadro?',
        opciones: ['Pincel', 'Zapatos', 'Mesa'],
        correcta: 'Pincel'
      }
    ],
  };

  function cargarVoces() {
    return new Promise((resolve) => {
      let voices = speechSynthesis.getVoices();
      if (voices.length) {
        resolve(voices);
      } else {
        speechSynthesis.onvoiceschanged = () => {
          voices = speechSynthesis.getVoices();
          resolve(voices);
        };
      }
    });
  }

  async function seleccionarVoz() {
    const voices = await cargarVoces();
    if (genero === 'ni√±o') {
      vozSeleccionada = voices.find(v => /child|male/i.test(v.name)) || voices.find(v => /male/i.test(v.name)) || voices[0];
    } else {
      vozSeleccionada = voices.find(v => /child|female/i.test(v.name)) || voices.find(v => /female/i.test(v.name)) || voices[0];
    }
  }

  async function seleccionarGenero(gen) {
    const input = document.getElementById('nombreInput');
    if (!input.value.trim()) {
      alert('Por favor escribe tu nombre.');
      return;
    }
    nombre = input.value.trim();
    genero = gen;
    document.body.className = gen;
    await seleccionarVoz();
    mostrarMenu();
    hablar(`¬°Hola ${nombre}, bienvenido a Aprendo Contigo! Elige un √°rea para comenzar a aprender.`);
  }

  // Funci√≥n que limpia emojis y caracteres especiales para que la voz no los lea
  function limpiarTexto(texto) {
    return texto.replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|[\uD83C-\uDBFF\uDC00-\uDFFF])/g, '').trim();
  }

  function hablar(texto) {
    const textoLimpio = limpiarTexto(texto);
    if (!vozSeleccionada) {
      const msg = new SpeechSynthesisUtterance(textoLimpio);
      msg.lang = 'es-MX';
      speechSynthesis.speak(msg);
      return;
    }
    const msg = new SpeechSynthesisUtterance(textoLimpio);
    msg.lang = 'es-MX';
    msg.voice = vozSeleccionada;
    speechSynthesis.speak(msg);
  }

  function mostrarMenu() {
    areaActual = '';
    juegoActual = 0;
    const app = document.getElementById('app');
    app.innerHTML = `
      <h2>üè† Men√∫ Principal</h2>
      <p>Hola ${nombre}, elige un √°rea para jugar:</p>
      <button onclick="iniciarArea('matematicas')">üî¢ Matem√°ticas</button>
      <button onclick="iniciarArea('lenguaje')">‚úèÔ∏è Lenguaje</button>
      <button onclick="iniciarArea('habilidadesSociales')">üë• Habilidades Sociales</button>
      <button onclick="iniciarArea('autonomia')">üßº Autonom√≠a</button>
      <button onclick="iniciarArea('creatividad')">üé® Creatividad</button>
    `;
  }

  function iniciarArea(area) {
    if (!juegos[area]) {
      alert('√Årea no disponible.');
      return;
    }
    areaActual = area;
    juegoActual = 0;
    mostrarJuego();
  }

  function mostrarJuego() {
    const juego = juegos[areaActual][juegoActual];
    const app = document.getElementById('app');
    app.innerHTML = `
      <h2>${tituloArea(areaActual)}</h2>
      <div class="question">${juego.preguntaVisual}</div>
      ${juego.opciones.map(opcion => `<button onclick="verificarRespuesta('${opcion}')">${opcion}</button>`).join('')}
      <div id="feedback"></div>
      <br/>
      <button onclick="mostrarMenu()">üîô Volver al men√∫</button>
    `;
    // Pasamos solo texto limpio para que la voz no lea emojis
    hablar(juego.preguntaTexto);
    document.getElementById('feedback').textContent = '';
  }

  function tituloArea(area) {
    switch(area) {
      case 'matematicas': return 'üî¢ Matem√°ticas';
      case 'lenguaje': return '‚úèÔ∏è Lenguaje';
      case 'habilidadesSociales': return 'üë• Habilidades Sociales';
      case 'autonomia': return 'üßº Autonom√≠a';
      case 'creatividad': return 'üé® Creatividad';
      default: return '';
    }
  }

  function verificarRespuesta(opcion) {
    const juego = juegos[areaActual][juegoActual];
    const feedback = document.getElementById('feedback');
    if (opcion === juego.correcta) {
      feedback.style.color = 'green';
      feedback.textContent = '¬°Muy bien! üéâ';
      hablar('Muy bien');
      juegoActual++;
      if (juegoActual >= juegos[areaActual].length) {
        setTimeout(() => {
          mostrarFinArea();
        }, 1200);
      } else {
        setTimeout(mostrarJuego, 1500);
      }
    } else {
      feedback.style.color = 'red';
      feedback.textContent = 'Int√©ntalo otra vez.';
      hablar('Int√©ntalo otra vez');
    }
  }

  function mostrarFinArea() {
    const app = document.getElementById('app');
    app.innerHTML = `
      <h2>üéâ ¬°Felicidades ${nombre}!</h2>
      <p>Terminaste todos los juegos de ${tituloArea(areaActual)}.</p>
      <button onclick="reiniciarArea()">üîÑ Repetir ${tituloArea(areaActual)}</button>
      <button onclick="mostrarMenu()">üè† Volver al men√∫ principal</button>
    `;
    hablar(`¬°Felicidades ${nombre}! Terminaste todos los juegos de ${tituloArea(areaActual)}. Puedes repetir los juegos o regresar al men√∫ principal.`);
  }

  function reiniciarArea() {
    juegoActual = 0;
    mostrarJuego();
  }
</script>
</body>
</html>
